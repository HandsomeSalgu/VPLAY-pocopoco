<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>크리에이티브 플랫폼</title>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<link href="/css/topbar.css" rel="stylesheet" type="text/css">
<link href="/css/common.css" rel="stylesheet" type="text/css">
<style>
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

body {
	font-family: Arial, sans-serif;
	margin-top: 30px !important;
	background-color: #191820;
	color: white;
}

.container {
	max-width: 1480px !important;
	margin: 0 auto !important;
}

.hero {
	display: grid;
	grid-template-columns: 1fr 1fr;
	gap: 40px;
	margin-bottom: 60px;
}

.hero-content h1 {
	font-size: 2.5rem;
	margin-bottom: 20px;
	line-height: 1.3;
}

.hero-content p {
	color: #9ca3af;
	margin-bottom: 30px;
	font-size: 0.95rem;
	line-height: 1.6;
}

.hero-buttons {
	display: flex;
	gap: 12px;
}

.button-primary {
	background-color: #5e37e9;
	color: white;
	padding: 12px 24px;
	border: none;
	border-radius: 6px;
	cursor: pointer;
}

.button-secondary {
	background-color: transparent;
	color: white;
	padding: 12px 24px;
	border: 1px solid rgba(255, 255, 255, 0.2);
	border-radius: 6px;
	cursor: pointer;
}

.hero-image {
	aspect-ratio: 1; /* 1:1 비율 */
	background-color: rgba(255, 255, 255, 0.1);
	border-radius: 8px;
}

.section {
	margin-bottom: 60px;
}

.section-title {
	font-size: 1.5rem;
	margin-bottom: 24px;
}

.event-carousel {
	position: relative;
	display: flex;
	gap: 20px;
}

.carousel-arrow {
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	width: 40px;
	height: 40px;
	background-color: rgba(255, 255, 255, 0.1);
	border: none;
	border-radius: 50%;
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
}

.carousel-arrow svg {
	width: 24px;
	height: 24px;
}

.carousel-arrow.left {
	left: -50px;
}

.carousel-arrow.right {
	right: -50px;
}

.carousel-arrow:hover {
	background-color: rgba(94, 55, 233, 0.8);
}

.template-grid {
	display: grid;
	grid-template-columns: repeat(3, 1fr);
	gap: 30px;
	cursor: pointer;
}
.template-item {
	aspect-ratio: 1;
	background-color: rgba(255, 255, 255, 0.1);
	border-radius: 8px;
}

.creator-grid {
	display: grid;
	grid-template-columns: repeat(4, 1fr);
	gap: 20px;
}

.creator-card {
	background-color: rgba(255, 255, 255, 0.05);
	border-radius: 12px;
	padding: 16px;
}

.creator-header {
	display: flex;
	align-items: center;
	gap: 12px;
	margin-bottom: 16px;
}

.creator-avatar {
	width: 32px;
	height: 32px;
	border-radius: 50%;
	background-color: rgba(255, 255, 255, 0.1);
}

.creator-info h3 {
	font-size: 0.9rem;
	margin-bottom: 4px;
}

.creator-info p {
	font-size: 0.8rem;
	color: #9ca3af;
}

.creator-content {
	aspect-ratio: 1;
	background-color: rgba(255, 255, 255, 0.1);
	border-radius: 8px;
	margin-bottom: 16px;
}

.subscribe-button {
	width: 100%;
	padding: 8px;
	background-color: rgba(255, 255, 255, 0.1);
	color: white;
	border: none;
	border-radius: 6px;
	cursor: pointer;
	font-size: 0.9rem;
}
.template-card {
	border-radius: 12px;
	display: flex;
	position: relative;
	overflow: hidden;
	flex-direction: column;
	height: 18rem;
}

.template-card:hover .overlay {
    backdrop-filter: blur(0px);
    -webkit-backdrop-filter: blur(0px);
}

.template-image img{
    transition-duration: 0.3s;
}

.template-card:hover .template-image img {
    scale: 1.1;
}

.template-image video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.template-image {
	width: 100%;
	height: 100%;
}

.content_wrap {
	display: flex;
	position: absolute;
	bottom: 0;
	z-index: 2;
	color: white;
	padding: 0.5rem 0.8rem;
	width: 100%;
	flex-direction: row;
	justify-content: space-between;
}

.overlay {
	position: absolute;
	inset: 0;
	background: rgba(0, 0, 0, 0.2);
	backdrop-filter: blur(4px);
	-webkit-backdrop-filter: blur(4px);
	z-index: 1;
	height: 6rem;
	top: 70%;
	transition-duration: 0.3s;
}

span.icon {
	margin-left: 0.7rem;
}

span.icon_wrap span {
	display: flex;
	flex-direction: column;
	align-content: center;
	flex-wrap: wrap;
}

span.icon_wrap {
	display: flex;
	align-items: flex-end;
}

.template-info {
	padding: 12px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
	background-color: rgba(255, 255, 255, 0.1);
	flex-grow: 1;
}

.template-details {
	height: 100%;
}

.template-title {
	font-size: 14px;
	font-weight: bold;
	color: #ffffff;
}

.template-creator {
	font-size: 12px;
	color: #d9d9d9;
}

.template-actions {
	display: flex;
	gap: 8px;
}

.action-button {
	width: 24px;
	height: 24px;
	background-color: transparent;
	border: none;
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
}

.bookmark-icon {
	color: #ffffff;
}

.like-icon {
	color: #ff4d4d;
}
</style>
</head>
<body>
	<div th:replace="~{views/common/topbar :: topbar}"></div>
	<div th:replace="~{views/common/floatingBtn}"></div>
	<div class="container">
		<section class="hero">
			<div class="hero-content">
				<h1>
					무제한의 크리에이티브<br>자산이 모두 한곳에<br> 있습니다.
				</h1>
				<p>
					지금 바로 크리에이터님의 무한 가능성을 경험해 보세요.<br> 디자인 자산을 자유롭게 활용하여 새로운 가능성을 발견할 수 있습니다.
				</p>
				<div class="hero-buttons">
					<button class="button-primary" onclick="location.href='/board/all_menu'">모든 카테고리 이동</button>
					<button class="button-secondary">프리뷰 및 워터마크</button>
				</div>
			</div>
			<div class="hero-image"></div>
		</section>

		<!-- 이벤트 섹션 -->
<!--		<section class="section">-->
<!--			<h2 class="section-title">진행중인 이벤트</h2>-->
<!--			<div class="event-carousel">-->
<!--				<button class="carousel-arrow left" aria-label="Previous Event">-->
<!--					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">-->
<!--        <path d="M15.75 19.5L8.25 12l7.5-7.5"></path>-->
<!--      </svg>-->
<!--				</button>-->
<!--				<button class="carousel-arrow right" aria-label="Next Event">-->
<!--					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">-->
<!--        <path d="M8.25 4.5L15.75 12l-7.5 7.5"></path>-->
<!--      </svg>-->
<!--				</button>-->
<!--			</div>-->
<!--			<div class="template-grid">-->
<!--				<div class="template-item">-->
<!--					<h3 id="monthlyEvent"></h3>-->
<!--				</div>-->
<!--				<div class="template-item"></div>-->
<!--				<div class="template-item"></div>-->
<!--				<div class="template-item"></div>-->
<!--			</div>-->
<!--		</section>-->

		<!-- MD 추천 템플릿 -->
		<section class="section">
			<h2 class="section-title">MD가 추천하는 템플릿 리스트</h2>
			<div class="template-grid" id="template-grid-wrap">
				<div class="template-card" th:each="md : ${mdList}">
					<input type="hidden" th:value=${md.contentNo}>
					<input type="hidden" th:value=${md.menuNo}>
					<div class="template-details">
						<div class="template-image"></div>
						<div class="overlay"></div>
						<div class="content_wrap">
							<div class="template-title">[[${md.contentTitle}]]</div>
							<span class="icon_wrap">
								<span class="icon">
									<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
									<path fill-rule="evenodd" clip-rule="evenodd" d="M7.9973 0C7.76163 0 7.53562 0.0894793 7.36897 0.248754C7.20233 0.408028 7.10871 0.62405 7.10871 0.849298V2.54789H1.77718C1.30584 2.54789 0.853809 2.72685 0.520523 3.0454C0.187238 3.36395 0 3.79599 0 4.24649V15.2874C0 15.7379 0.187238 16.1699 0.520523 16.4885C0.853809 16.807 1.30584 16.986 1.77718 16.986H14.2174C14.6888 16.986 15.1408 16.807 15.4741 16.4885C15.8074 16.1699 15.9946 15.7379 15.9946 15.2874V4.24649C15.9946 3.79599 15.8074 3.36395 15.4741 3.0454C15.1408 2.72685 14.6888 2.54789 14.2174 2.54789H8.88589V0.849298C8.88589 0.62405 8.79227 0.408028 8.62563 0.248754C8.45899 0.0894793 8.23297 0 7.9973 0ZM8.88589 2.54789V10.0455L10.5102 8.49298C10.6768 8.33362 10.9029 8.24404 11.1386 8.24396C11.3743 8.24388 11.6004 8.3333 11.7671 8.49255C11.9339 8.6518 12.0276 8.86784 12.0277 9.09313C12.0278 9.31843 11.9342 9.53452 11.7676 9.69389L8.78193 12.5467C8.57365 12.7456 8.29128 12.8573 7.99686 12.8573C7.70244 12.8573 7.42006 12.7456 7.21179 12.5467L4.22702 9.69389C4.14452 9.61498 4.07909 9.52131 4.03446 9.41823C3.98983 9.31516 3.96688 9.20469 3.96693 9.09313C3.96697 8.98158 3.99 8.87112 4.0347 8.76808C4.0794 8.66503 4.1449 8.57141 4.22746 8.49255C4.31002 8.4137 4.40802 8.35116 4.51587 8.30851C4.62371 8.26586 4.73929 8.24392 4.85601 8.24396C4.97272 8.244 5.08829 8.26601 5.1961 8.30874C5.30392 8.35147 5.40187 8.41407 5.48437 8.49298L7.10871 10.0455V2.54789H8.88589Z" fill="white"/>
									</svg>
									<span>[[${md.downloadCount}]]</span>
								</span>
								<span class="icon" id="md-icon">
									<th:block th:if="${md.likeTo == 1}">
									<svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M8.40374 1.14511C8.17373 1.34511 7.82073 1.34511 7.59173 1.14511C5.80971 -0.404898 3.16169 -0.462898 1.34268 1.47411C-2.64136 6.51912 3.14269 10.9711 6.95772 13.6691C7.2618 13.8844 7.62518 14 7.99773 14C8.37029 14 8.73366 13.8844 9.03774 13.6691C12.8808 10.9581 18.6378 6.51912 14.6528 1.47411C12.8348 -0.462898 10.1848 -0.404898 8.40274 1.14511" fill="red"/>
									</svg>
									</th:block>
									<th:block th:unless="${md.likeTo == 1}">
									<svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M8.40374 1.14511C8.17373 1.34511 7.82073 1.34511 7.59173 1.14511C5.80971 -0.404898 3.16169 -0.462898 1.34268 1.47411C-2.64136 6.51912 3.14269 10.9711 6.95772 13.6691C7.2618 13.8844 7.62518 14 7.99773 14C8.37029 14 8.73366 13.8844 9.03774 13.6691C12.8808 10.9581 18.6378 6.51912 14.6528 1.47411C12.8348 -0.462898 10.1848 -0.404898 8.40274 1.14511" fill="white"/>
									</svg>
									</th:block>
									<span>[[${md.likeCount}]]</span>
								</span>
							</span>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- 크리에이터 섹션 -->
		<section class="section">
			<h2 class="section-title">최근 인기 크리에이터 추천</h2>
			<div class="creator-grid">
				<div class="creator-card">
					<div class="creator-header">
						<div class="creator-avatar"></div>
						<div class="creator-info">
							<h3>Creator</h3>
							<p>Handsome/given</p>
						</div>
					</div>
					<div class="creator-content"></div>
					<button class="subscribe-button">Subscribe</button>
				</div>
				<div class="creator-card">
					<div class="creator-header">
						<div class="creator-avatar"></div>
						<div class="creator-info">
							<h3>Creator</h3>
							<p>Handsome/given</p>
						</div>
					</div>
					<div class="creator-content"></div>
					<button class="subscribe-button">Subscribe</button>
				</div>
				<div class="creator-card">
					<div class="creator-header">
						<div class="creator-avatar"></div>
						<div class="creator-info">
							<h3>Creator</h3>
							<p>Handsome/given</p>
						</div>
					</div>
					<div class="creator-content"></div>
					<button class="subscribe-button">Subscribe</button>
				</div>
				<div class="creator-card">
					<div class="creator-header">
						<div class="creator-avatar"></div>
						<div class="creator-info">
							<h3>Creator</h3>
							<p>Handsome/given</p>
						</div>
					</div>
					<div class="creator-content"></div>
					<button class="subscribe-button">Subscribe</button>
				</div>
			</div>
		</section>

		<section class="section">
			<h2 class="section-title">탑 크리에이터 추천</h2>
			<div class="creator-grid top">
				<div class="creator-card" th:each="l, rank : ${ulist}">
					<input type="hidden" th:value="${l.userNo}">
					<div class="creator-header">
						<div class="creator-avatar"></div>
						<div class="creator-info">
							<h3>[[${l.userNickname}]]</h3>
							<p>팔로잉 : [[${l.subscriber}]]</p>
						</div>
					</div>
					<div class="creator-content">
						<p>순위 : #[[${rank.index + 1}]]</p>
					</div>
					<button class="subscribe-button">+</button>
				</div>
			</div>
		</section>

		<section class="section">
			<h2 class="section-title">탑 템플릿 리스트</h2>
			<div class="template-grid">
				<div class="template-card" th:each="c, rank : ${clist}">
					<div class="template-image"></div>
					<div class="template-info">
						<div class="template-details">
							<div class="template-title">[[${c.contentTitle}]]</div>
							<div class="template-creator">[[${c.userNickName}]]</div>
						</div>
						<div class="template-actions">
							<button class="action-button bookmark-icon">
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
							</button>
							[[${c.views}]]
							<button class="action-button like-icon">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
							[[${c.likeCount}]]
							</button>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>

	<script th:inline="javascript">
		const loginUser = /*[[${session.loginUser}]]*/'loginUser';
		const creatorList = document.querySelector('.creator-grid.top');

		var showAlert = "[[${showAlert}]]";
		console.log(showAlert);
		if (showAlert.trim() === "true") {
			console.log(showAlert);
			alert("결제일이 지났습니다.");
		}

		window.onload=()=>{
			
// 			console.log(mdIcon);
			const mdList = document.getElementById('template-grid-wrap');
			[...mdList.children].map((template, index, array) =>{
				
				const thumbnail = template.children[2].children[0];
				const contentNo = template.children[0].value;
				const menuNo = template.children[1].value;
				
				//썸네일 불러오기
				fetch("/board/select-thumbnail/" + contentNo,{
					method : 'get',
					headers : {'content-type' : 'application/json; charset=UTF-8'}
				})
				.then(response => response.json())
				.then(data=>{
					console.log(data);
					if(menuNo == 1 || menuNo == 5){
						const video = document.createElement('video');
						video.muted = true;
						video.loop = true;

						const source = document.createElement("source");
						source.type = "video/mp4";
						source.src = data.thumbnail;

						video.appendChild(source);
						thumbnail.appendChild(video);

						template.addEventListener('mouseenter', function(){
							video.play();
						});

						template.addEventListener('mouseleave', function(){
							video.pause();
							video.currentTime = 0;
						});
					}else if(menuNo == 4 || menuNo == 6 || menuNo == 7 || menuNo == 2){
						const img = document.createElement('img');
						img.src = data.thumbnail;

						thumbnail.appendChild(img);
					}

				})
				
				//컨텐츠 이동
				template.addEventListener('click', function(event){
					
					switch(menuNo){
					case "1": menuName = "video-templates"; break;
					case "2": menuName = "music"; break;
					case "3": menuName = "sound-effect"; break;
					case "4": menuName = "graphic-templates"; break;
					case "5": menuName = "stock-video"; break;
					case "6": menuName = "photo"; break;
					case "7": menuName = "font";
					}
					
// 					console.log(menuName);
					
					location.href = "/board/" + menuName + "/" + contentNo;
				});
				
				const like = template.children[2].children[2].children[1].children[1].children[0];
				const view = (like.nextElementSibling);
				
				like.addEventListener('click', function(event){
					if(loginUser != null){
						if(this.children[0].getAttribute("fill") == 'white'){
							fetch('/board/like', {
								method : 'put',
								headers : {'content-type':'application/json; charset=UTF-8'},
								body: JSON.stringify({
									contentNo: contentNo
				    			})
							})
							.then(response => response.json())
							.then(data =>{
								this.children[0].setAttribute("fill", "red");
								view.innerText = Number((view.innerText)) + 1;
							})
						}else if(this.children[0].getAttribute("fill") == 'red'){
							fetch('/board/like', {
								method : 'delete',
								headers : {'content-type':'application/json; charset=UTF-8'},
								body: JSON.stringify({
									contentNo: contentNo
				    			})
							})
							.then(response => response.json())
							.then(data =>{
								this.children[0].setAttribute("fill", "white");
								view.innerText = Number((view.innerText)) - 1;
							})
						}
					}else{
						alert('로그인 후 이용해주세요');
					}
					event.stopPropagation();
				})
			})
		}


		[...creatorList.children].map((creator, index, array) =>{
			creator.addEventListener('click', function(){
				const userNo = this.querySelector('input').value;
				console.log(userNo);
				location.href = "/users/creator/" + userNo;
			})
		})

	</script>
</body>
</html>